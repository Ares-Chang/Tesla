var geoip2=function(){"use strict";function t(t,e,o,n,s,i,r){this.successCallback=t,this.errorCallback=e,this.geolocation=o&&o.hasOwnProperty("geolocation")?o.geolocation:navigator.geolocation,this.endpoint=s&&""!=s?s:"",this.context=!i||"production"!=i&&"staging"!=i?"production":i,this.version=r&&""!=r&&-1!=r.indexOf("v")?r:"v1.0.3",this.type=n}function e(t,e){var o=new XMLHttpRequest,s=Math.random();try{o.open(t,n(e,"pc",s),!0)}catch(t){o=null}return o}function o(t){for(var e=window.location.search.substring(1).split("&"),o=0;o<e.length;o++){var n=e[o].split("=");if(n[0]===t)return n[1]}return!1}function n(t,e,o){var n=new RegExp("([?&])"+e+"=.*?(&|$)","i"),s=-1!==t.indexOf("?")?"&":"?";return t.match(n)?t.replace(n,"$1"+e+"="+o+"$2"):t+s+e+"="+o}var s={};return t.prototype.returnSuccess=function(t){this.successCallback&&"function"==typeof this.successCallback&&this.successCallback(t)},t.prototype.getGeoIPResult=function(){var t,s=this,i=s.context,r=s.endpoint;-1===window.location.hostname.indexOf("tesla.cn")?"production"==i?r="https://location.teslamotors.com/geoip/"+this.version+"/"+this.type+"/":""==r&&(r="http://sjc04s1gipap01.teslamotors.com:1112/geoip/"+this.version+"/"+this.type+"/"):r="production"==i?"https://location.tesla.cn/geoip/"+this.version+"/"+this.type+"/":"http://sjc04s1gipap01.teslamotors.com:1112/geoip/"+this.version+"/"+this.type+"/",o("ip")&&(r=n(r,"ip",o("ip"))),(t=e("get",r))?(-1==navigator.userAgent.indexOf("Trident")?t.onreadystatechange=function(){if(4===t.readyState)if(t.status<200||t.status>=400)s.errorCallback();else try{var e=JSON.parse(t.responseText);s.returnSuccess(e)}catch(t){s.errorCallback()}}:t.readyState&&(t.onload=function(){if(t.status<200||t.status>=400)s.errorCallback(t.status);else try{var e=JSON.parse(t.responseText);s.returnSuccess(e)}catch(t){s.errorCallback()}}),t.send(t.responseText)):s.errorCallback()},s.country=function(e,o,n,s,i,r){new t(e,o,n,"country",s,i,r).getGeoIPResult()},s.city=function(e,o,n,s,i,r){new t(e,o,n,"city",s,i,r).getGeoIPResult()},s.connection=function(e,o,n,s,i,r){new t(e,o,n,"connection",s,i,r).getGeoIPResult()},s}();